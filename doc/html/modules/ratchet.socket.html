<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
	<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>LuaDoc</h1>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h1>Modules</h1>
<ul>

	<li>
		<a href="../modules/ratchet.html">ratchet</a>
	</li>

	<li>
		<a href="../modules/ratchet.dns.html">ratchet.dns</a>
	</li>

	<li>
		<a href="../modules/ratchet.http.client.html">ratchet.http.client</a>
	</li>

	<li>
		<a href="../modules/ratchet.http.server.html">ratchet.http.server</a>
	</li>

	<li><strong>ratchet.socket</strong></li>
	
	<li>
		<a href="../modules/ratchet.ssl.html">ratchet.ssl</a>
	</li>

	<li>
		<a href="../modules/ratchet.ssl.session.html">ratchet.ssl.session</a>
	</li>

	<li>
		<a href="../modules/ratchet.timerfd.html">ratchet.timerfd</a>
	</li>

	<li>
		<a href="../modules/ratchet.zmqsocket.html">ratchet.zmqsocket</a>
	</li>

</ul>



<!-- File list -->






</div><!-- id="navigation" -->

<div id="content">

<h1>Module <code>ratchet.socket</code></h1>

<p>The socket library provides an implementation of the standard Berkeley sockets on top of the ratchet library. Any methods that pause execution MUST be called from within a thread attached to a ratchet object. This library is also intended for use alongside calls to ratchet:resolve_dns(), see the manual for examples.</p>





<h2>Functions</h2>
<table class="function_list">

	<tr>
	<td class="name" nowrap><a href="#accept">accept</a>&nbsp;(self)</td>
	<td class="summary">Pauses the current thread until a new connection to the socket is attempted.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#bind">bind</a>&nbsp;(self, sockaddr)</td>
	<td class="summary">Binds the socket to the given sockaddr, corresponding to the bind() system call.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#check_ok">check_ok</a>&nbsp;(self)</td>
	<td class="summary">Gets the current state of the socket.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#close">close</a>&nbsp;(self)</td>
	<td class="summary">Closes the socket internal file descriptor.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#connect">connect</a>&nbsp;(self, sockaddr)</td>
	<td class="summary">Attempts a connection to the given sockaddr and pauses the thread until it is completed.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#encrypt">encrypt</a>&nbsp;(self, context)</td>
	<td class="summary">Creates and attaches an encryption session to the socket, based on the given context.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#from_fd">from_fd</a>&nbsp;(fd)</td>
	<td class="summary">Returns a new socket object, using the given file descriptor.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#get_encryption">get_encryption</a>&nbsp;(self)</td>
	<td class="summary">Returns the current encryption session for the socket.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#get_fd">get_fd</a>&nbsp;(self)</td>
	<td class="summary">Returns the internal socket file descriptor.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#get_timeout">get_timeout</a>&nbsp;(self)</td>
	<td class="summary">Gets the current timeout for all socket methods that pause the thread.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#listen">listen</a>&nbsp;(self, backlog)</td>
	<td class="summary">Sets the socket to listen mode.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#new">new</a>&nbsp;(family, socktype, protocol)</td>
	<td class="summary">Returns a new socket object, with its own file descriptor.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#prepare_tcp">prepare_tcp</a>&nbsp;(host, port)</td>
	<td class="summary">Prepares TCP socket information.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#prepare_udp">prepare_udp</a>&nbsp;(path)</td>
	<td class="summary">Prepares UNIX socket information.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#prepare_udp">prepare_udp</a>&nbsp;(path)</td>
	<td class="summary">Prepares UNIX socket information.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#prepare_uri">prepare_uri</a>&nbsp;(uri)</td>
	<td class="summary">URI parser for socket connection strings.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#recv">recv</a>&nbsp;(self)</td>
	<td class="summary">Attempts to receive data from across the socket, pausing the thread until data is available.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#send">send</a>&nbsp;(self, data)</td>
	<td class="summary">Attempts to send the given data across the socket, pausing the thread until it is able to do so.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#set_timeout">set_timeout</a>&nbsp;(self, seconds)</td>
	<td class="summary">Sets the current timeout for all socket methods that pause the thread.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#shutdown">shutdown</a>&nbsp;(self, what)</td>
	<td class="summary">Shuts down portions of the socket, corresponding to the system call of the same name.</td>
	</tr>

</table>






<br/>
<br/>



<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="accept"></a><strong>accept</strong>&nbsp;(self)</dt>
<dd>
Pauses the current thread until a new connection to the socket is attempted. The current socket MUST have called listen().


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>






<h3>Return value:</h3>
a new socket object for the connection, followed by a string with the IP address of the connecting host.



</dd>




<dt><a name="bind"></a><strong>bind</strong>&nbsp;(self, sockaddr)</dt>
<dd>
Binds the socket to the given sockaddr, corresponding to the bind() system call. This method must be used for sockets that call listen(), and may be used for sockets that call connect() when it is desired to connect from a specific network interface.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  sockaddr: a sockaddr userdata object.
	</li>
	
</ul>








</dd>




<dt><a name="check_ok"></a><strong>check_ok</strong>&nbsp;(self)</dt>
<dd>
Gets the current state of the socket. If a fatal socket error has occurred, a Lua error is raised on the current thread.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>






<h3>Return value:</h3>
true if the socket is okay, false otherwise followed by info.



</dd>




<dt><a name="close"></a><strong>close</strong>&nbsp;(self)</dt>
<dd>
Closes the socket internal file descriptor. This is called automatically when the socket object is collected, for convenience.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>








</dd>




<dt><a name="connect"></a><strong>connect</strong>&nbsp;(self, sockaddr)</dt>
<dd>
Attempts a connection to the given sockaddr and pauses the thread until it is completed.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  sockaddr: a sockaddr userdata object.
	</li>
	
</ul>






<h3>Return value:</h3>
true if the connection succeeded, false otherwise.



</dd>




<dt><a name="encrypt"></a><strong>encrypt</strong>&nbsp;(self, context)</dt>
<dd>
Creates and attaches an encryption session to the socket, based on the given context. Once this session is created, it handles all calls to the send()/recv() methods.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  context: a ratchet.ssl context object.
	</li>
	
</ul>






<h3>Return value:</h3>
the new encryption session for the socket.



</dd>




<dt><a name="from_fd"></a><strong>from_fd</strong>&nbsp;(fd)</dt>
<dd>
Returns a new socket object, using the given file descriptor. This is particularly useful when sockets are returned by the accept() system call.


<h3>Parameters</h3>
<ul>
	
	<li>
	  fd: an existing file descriptor of a socket.
	</li>
	
</ul>






<h3>Return value:</h3>
a new socket object.



</dd>




<dt><a name="get_encryption"></a><strong>get_encryption</strong>&nbsp;(self)</dt>
<dd>
Returns the current encryption session for the socket.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>






<h3>Return value:</h3>
the encryption session, or nil if unencrypted.



</dd>




<dt><a name="get_fd"></a><strong>get_fd</strong>&nbsp;(self)</dt>
<dd>
Returns the internal socket file descriptor.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>






<h3>Return value:</h3>
a file descriptor.



</dd>




<dt><a name="get_timeout"></a><strong>get_timeout</strong>&nbsp;(self)</dt>
<dd>
Gets the current timeout for all socket methods that pause the thread.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>






<h3>Return value:</h3>
the current timeout in seconds.



</dd>




<dt><a name="listen"></a><strong>listen</strong>&nbsp;(self, backlog)</dt>
<dd>
Sets the socket to listen mode. This socket will open the system port it was bind()ed to. Connections to this socket can be accepted by the accept() method.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  backlog: optional maximum length of pending connections queue.
	</li>
	
</ul>








</dd>




<dt><a name="new"></a><strong>new</strong>&nbsp;(family, socktype, protocol)</dt>
<dd>
Returns a new socket object, with its own file descriptor.


<h3>Parameters</h3>
<ul>
	
	<li>
	  family: the protocol family which will be used for communication.
	</li>
	
	<li>
	  socktype: specifies the communication semantics.
	</li>
	
	<li>
	  protocol: specifies a particular protocol to be used.
	</li>
	
</ul>






<h3>Return value:</h3>
a new socket object.



</dd>




<dt><a name="prepare_tcp"></a><strong>prepare_tcp</strong>&nbsp;(host, port)</dt>
<dd>
Prepares TCP socket information. On success, the returned object contains all necessary data to create and bind/connect a new socket object. See the manual page for complete details.


<h3>Parameters</h3>
<ul>
	
	<li>
	  host: queried by DNS for new TCP connection.
	</li>
	
	<li>
	  port: destination port number for new TCP connection.
	</li>
	
</ul>






<h3>Return value:</h3>
Table of information useful in creating a new socket, or nil on failure followed by an error. See the manual for details.



</dd>




<dt><a name="prepare_udp"></a><strong>prepare_udp</strong>&nbsp;(path)</dt>
<dd>
Prepares UNIX socket information. On success, the returned object contains all necessary data to create and bind/connect a new socket object. See the manual page for complete details.


<h3>Parameters</h3>
<ul>
	
	<li>
	  path: file-path to connect/create UNIX socket.
	</li>
	
</ul>






<h3>Return value:</h3>
Table of information useful in creating a new socket, or nil on failure followed by an error. See the manual for details.



</dd>




<dt><a name="prepare_udp"></a><strong>prepare_udp</strong>&nbsp;(path)</dt>
<dd>
Prepares UNIX socket information. On success, the returned object contains all necessary data to create and bind/connect a new socket object. See the manual page for complete details.


<h3>Parameters</h3>
<ul>
	
	<li>
	  path: file-path to connect/create UNIX socket.
	</li>
	
</ul>






<h3>Return value:</h3>
Table of information useful in creating a new socket, or nil on failure followed by an error. See the manual for details.



</dd>




<dt><a name="prepare_uri"></a><strong>prepare_uri</strong>&nbsp;(uri)</dt>
<dd>
URI parser for socket connection strings. On success, the returned object contains all necessary data to create and bind/connect a new socket object. The parser is capable of creating TCP, UDP, and Unix sockets. See the manual page for complete details.


<h3>Parameters</h3>
<ul>
	
	<li>
	  uri: the URI connection string.
	</li>
	
</ul>






<h3>Return value:</h3>
Table of information useful in creating a new socket, or nil on failure followed by an error. See the manual for details.



</dd>




<dt><a name="recv"></a><strong>recv</strong>&nbsp;(self)</dt>
<dd>
Attempts to receive data from across the socket, pausing the thread until data is available. As in the system call, recv() will return an empty string if the other end has shutdown.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
</ul>






<h3>Return value:</h3>
string of data received on the socket.



</dd>




<dt><a name="send"></a><strong>send</strong>&nbsp;(self, data)</dt>
<dd>
Attempts to send the given data across the socket, pausing the thread until it is able to do so.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  data: a string of data to send.
	</li>
	
</ul>








</dd>




<dt><a name="set_timeout"></a><strong>set_timeout</strong>&nbsp;(self, seconds)</dt>
<dd>
Sets the current timeout for all socket methods that pause the thread.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  seconds: the new timeout in seconds.
	</li>
	
</ul>








</dd>




<dt><a name="shutdown"></a><strong>shutdown</strong>&nbsp;(self, what)</dt>
<dd>
Shuts down portions of the socket, corresponding to the system call of the same name. You can shut down reads, writes, or both.


<h3>Parameters</h3>
<ul>
	
	<li>
	  self: the socket object.
	</li>
	
	<li>
	  what: either "read", "write", or "both". Default "both".
	</li>
	
</ul>








</dd>


</dl>






</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
